getwd()
setwd("/Users/yigitonay/Documents/GitHub/mef06g-time-and-space")
getwd()
#Calculation and plot of weighted average financial indicators
bs_df_economy <- bs_df %>%
mutate(current_ratio = bs_df$"I-Current_assets" / bs_df$"III-Short-term_liabilities",
leverage = bs_df$"III-Short-term_liabilities" / bs_df$"Total_assets",
return_on_equity = bs_df$"net_income_is" / bs_df$"V-Own_funds",
return_on_assets = bs_df$"net_income_is" / bs_df$"Total_assets") %>%
select(c(sector_code:year),c(current_ratio:return_on_assets), Total_assets)
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(readxl)
library(ggridges)
library(scales)
library(gt)
library(rmarkdown)
library(quarto)
library(knitr)
library(data.table)
library(ggthemes)
library(viridis)
bs <- readRDS("docs/Project_Data/balance_sheet.rds")
i_s <- readRDS("docs/Project_Data/income_statement.rds")
trade_df <- readRDS("docs/Project_Data/trade.rds")
price_df <- readRDS("docs/Project_Data/input_cost.rds")
gdp_df <- readRDS("docs/Project_Data/gdp.rds")
bs$accounts <- bs$accounts %>% gsub("\\s+", "_", .)
bs_df <- bs %>%
filter(accounts %in% c("I-Current_assets",
"III-Short-term_liabilities",
"IV-Long-term_liabilities",
"Total_assets",
"V-Own_funds")) %>%
pivot_wider(names_from = accounts, values_from = value)
i_s$accounts <- i_s$accounts %>% gsub("\\s+", "_", .)
net_income <- i_s %>%
filter(accounts == "Net_profit_or_loss_for_the_financial_year") %>%
pivot_wider(names_from = accounts, values_from = value) %>%
pull(Net_profit_or_loss_for_the_financial_year)
bs_df <- bs_df %>% mutate(net_income_is = net_income)
bs_df_new <- bs_df %>%
mutate(current_ratio = bs_df$"I-Current_assets" / bs_df$"III-Short-term_liabilities",
leverage = bs_df$"III-Short-term_liabilities" / bs_df$"Total_assets",
return_on_equity = bs_df$"net_income_is" / bs_df$"V-Own_funds",
return_on_assets = bs_df$"net_income_is" / bs_df$"Total_assets") %>%
select(c(sector_code:year),c(current_ratio:return_on_assets))
bs_df_new <- bs_df_new %>%
pivot_longer(cols = c("current_ratio", "leverage", "return_on_equity", "return_on_assets"),
names_to = "Indicator",
values_to = "Value")
#Calculation and plot of weighted average financial indicators
bs_df_economy <- bs_df %>%
mutate(current_ratio = bs_df$"I-Current_assets" / bs_df$"III-Short-term_liabilities",
leverage = bs_df$"III-Short-term_liabilities" / bs_df$"Total_assets",
return_on_equity = bs_df$"net_income_is" / bs_df$"V-Own_funds",
return_on_assets = bs_df$"net_income_is" / bs_df$"Total_assets") %>%
select(c(sector_code:year),c(current_ratio:return_on_assets), Total_assets)
bs_df_economy_graph <- bs_df_economy %>%
group_by(year) %>%
summarize(Liquidity = weighted.mean(current_ratio, Total_assets) * 100,
Leverage = weighted.mean(leverage, Total_assets) * 100,
Profitability = weighted.mean(return_on_assets, Total_assets) * 100)
bs_df_economy_graph %>%
pivot_longer(-year, names_to = "indicator_yearly", values_to = "value") %>%
ggplot(aes(x = year, y = value)) +
geom_line() +
facet_wrap(~indicator_yearly, scales = "free") +
theme_bw() +
labs(y = "Levels", title = "Weighted Average of Financial Indicators")
#Calculation and plot of standard deviation of financial indicators
bs_df_economy %>%
group_by(year) %>%
summarize(Liquidity = sd(current_ratio) * 10,
Leverage = sd(leverage) * 10,
Profitability = sd(return_on_assets) * 10) %>%
pivot_longer(-year, names_to = "std_yearly", values_to = "value") %>%
ggplot(aes(x = year, y = value)) +
geom_line() +
facet_wrap(~std_yearly, scales = "free") +
theme_bw()+
labs(y = "Levels", title = "Standard Deviation of Financial Indicators")
colnames(bs_df_economy_graph) <- c("Year", "Liquidity", "Leverage", "Profitability")
bs_df_economy_graph[,2:4] <- lapply(bs_df_economy_graph[,2:4],
FUN = function(x) round(x, 2))
kable(bs_df_economy_graph)
